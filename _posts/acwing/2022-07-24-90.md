---
layout: post
title: "Acwing 90. 64位整数乘法"
categories: solution acwing
---
> 题目链接：<a href="https://www.acwing.com/problem/content/92/" target="_blank">90. 64位整数乘法 - AcWing题库</a>

因为 C++ 内置的最高整数类型是 64 位，若运算 $a * b \mod p$ 中的三个变量 $a,b,p$ 都在 $10^{18}$ 级别，则不存在一个可供强制转换的 128 位整数类型，我们需要一些特殊的处理办法。

## 方法一
类似于快速幂的思想，把整数 $b$ 用二进制表示，即
> $$b=c_{k-1}2^{k-1}+c_{k-2}2^{k-2}+\cdots+c_02^0$$

那么
> $$a*b=c_{k-1}*a*2^{k-1}+c_{k-2}*a*2^{k-2}+\cdots+c_0*a*2^0$$

因为
> $$a*2^i=(a*2^{i-1})*2$$

若已求出 $$ {a*2^i-1 \mod p} $$ ，则计算 $$(a*2^{i-1})*2\mod a$$ 时，运算过程中每一步的结果都不超过 $$2*10^{18}$$，仍在64位整数 long long 的表示范围内，所以很容易通过 $$k$$ 次地推求出每个乘积项。当 $$c_i=1$$ 时，把该乘积项累计加到答案中即可。时间复杂度为 $$O(log_2b)$$。