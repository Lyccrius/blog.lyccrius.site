---
layout: post
title: "Day1 线段树的进阶用法"
date:   2022-09-30
categories: course luogu-class yugu22smi1
---

## 普通线段树（回顾）

### 什么是线段树？

线段树是一种维护区间信息的二叉树

每个叶子节点存储的是一个长度为 $1$ 的区间信息

第 $i$ 个节点的孩子为 $i * 2$ 和 $i * 2 + 1$

每个非叶子结点表示的区间是两个孩子区间的并

### 线段树的操作

* 线段树的节点个数是 $2n - 1$
* 对一个序列建立一颗线段树：$\mathcal{O}(n)$
    * 自底向上初始化每个节点
    * 叶子节点只表示一个元素，可以直接赋值
    * 非叶子节点的信息从两个孩子处合并
* 单点修改：$\mathcal{O}(\log{n})$
    * 先自顶向下，寻找覆盖修改元素的所有区间
    * 然后自底向上依次进行修改
* 查询区间信息：$\mathcal{O}(\log{n})$
    * 自顶向下递归
    * 如果当前区间和询问区间没有交集，返回空
    * 如果当前区间是询问区间的子集，返回整个区间的信息
    * 否则，递归两个孩子

### 线段树区间修改

* 对于区间修改操作，我们需要用到 Lazy 标记
* 节点 $i$ 的 Lazy 标记表示 $i$ 的整个子树都需要修改，但是我们现在不急着用
* 当任何修改或者询问操作需要访问到 $i$ 的子树时，再将标记进行下放

## 权值线段树

## 线段树上二分

## 动态开节点线段树

## 可持久化线段树