---
layout: post
title:  day3 数学
date: 2022-08-03
author: 袁浩天
categories: course qbxt 66
---

# 数论

## 质数判定

* 暴力：$\mathcal O(\sqrt p)$
* 从 $2$ 枚举到 $\sqrt p$

## 质数判定 Miller-Rabin

* 费马定理：$p ~ prime, a \in \N, (a, p) = 1 \rightarrow a^{p - 1} \equiv 1 (\bmod p)$
* 引理：$p$ 是质数则 $x^2 \equiv 1 (\bmod p)$ 的解只有 $1, -1$
  * 如果 $x^2 \equiv 1 (\bmod p)$ 的解只有 $1, -1$，$p$ 不一定是质数（$p \ge 2$）

* $p - 1 = 2^s \times t$
* 选取任意整数 $a$
* $a^t, a^{2t}, a^{4t}, \cdots, a^{2^s t} = 1$
* 找到最后一个 $1$，并检查是否满足引理，若不满足则一定不是质数

* 存在伪质数，所以需要多选取不同的 $a$

|$n \le$|$a$|
|:-:|:-:|
|$2047$|$2$|
|$1373653$|$2, 3$|
|$9080191$|$31, 73$|
|$25326001$|$2, 3, 5$|
|$4759123141$|$2, 7, 61$|
|$1122004669633$|$2, 3, 13, 1662803$|
|$2152302898747$|$2, 5, 7, 11$|
|$3474749660383$|$2, 5, 7, 11, 13$|
|$341550071728321$|$2, 3, 5, 7, 11, 13, 17$|
|$3825123056546413051$|$2, 3, 5, 7, 11, 13, 17, 19$|

* 时间复杂度 $\mathcal O(\lvert A \rvert s) \sim \mathcal O(\lvert A \rvert \log o)$，如果使用龟速乘会多一个 $\log$

## 质因数分解

* 暴力：$\mathcal O(\sqrt p)$

## 质因数分解 pollard-rho

* 特判质数，找到一个因数，分成两半，递归处理。
* 怎么找因数？
* 如果存在两个数差为原数 $\gcd$ 不为 $1$，则找到了一个因数。那么选取一个集合，这个集合只要大小为 $\mathcal O(n^{\frac{1}{4}})$，就大概率存在这样一对数。
* $f(x) = x^2 + c$
* $x \rightarrow f(x) \rightarrow f(f(x)) \rightarrow \cdots$
* 会形成一个环。
* 如果 $\gcd(x - y, n) \gt 1$，那么不难发现 $\gcd(f(x) - f(y), n) \gt 1$
* 所以我们只需要检查环上固定距离的点对即可。
* $A = B = r_0$
* $A = f(A), B = f(f(B))$
* 每次两个点的距离会增加 $1$，如果某一个时刻 $A = B$，则重新选点。
* 时间复杂度 $\mathcal O(n^{\frac{1}{4}})$

## 筛法

* 埃式筛：用 $1 \sim \sqrt n$ 的质数，筛掉合数。
* 时间复杂度 $\mathcal O(n \log \log n)$

## 亚线性筛

* 数论函数：定义域为正整数的函数。
* 积性函数：$\forall (x, y) = 1, f(x) f(y) = f(x y)$ 的数论函数
* $\mu(x), \phi(x)$，以及一般的无系数单项式 $x^t$ 都是积性函数。

## Min25 筛

* 目标：给定函数 $f$，在低于线性的时间内求出 $\sum_{i = 1}^n f(i)$
* 对函数 $f$ 的限制：
  * 积性
  * $f(p), p \in P$ 能够被表示成项数较少的多项式。
  * $f(p^c), p \in P$ 能够快速求值。

## 莫比乌斯反演

## 中国剩余定理（CRT）

* 问题等价于 $n = 2$ 的情况，对于 $n \gt 2$ 的情况拆分成若干 $n = 2$ 即可。

* $X \equiv a_1 (\bmod m_1)$
* $X \equiv a_2 (\bmod m_2)$

* $k_2 m_2 \equiv 1 (\bmod m_1)$
* $k_1 m_1 \equiv 1 (\bmod m_2)$

* $X = a_1 k_2 m_2 + a_2 k_1 m_1$

## 原根

* 定义：模 $m$ 的阶正好为 $\phi(m)$ 的整数 $a$
* 即 $a, a^2, \cdots, a^{\phi(m)}$，不重复。

* 假设 $m$ 是质数，那么根据原根生成的序列正好包含了 $1, \cdots, p - 1$ 所有数，构成了一个循环群。
* 乘法 $\rightarrow$ 加法

* 怎么找原根
* ~~暴力~~

* 一个质数的原根其实非常多，有 $\phi (p - 1)$ 个，所以直接暴力枚举。
* 枚举 $p - 1$ 的因数考察是否为循环节。

* 问题：给定质数 $p$，和原根 $g$，以及整数 $x$，如何快速求 $x$ 的下标？

* $\text{BSGS}$，选取 $K \sim \mathcal O(\sqrt p)$，预处理 $g^K, g^{2k}, \cdots$
* 枚举 $g, g^2, \cdots, g^{k - 1}$，查询是否能拼成 $x$。

## 二次剩余

* 问题：给定质数 $p$，整数 $n$，求解二次同于方程：$x^2 \equiv n (\bmod p)$
* 若存在解，则称 $n$ 是模 $p$ 的二次剩余，否则称 $n$ 是模 $p$ 的非二次剩余。

* 简易做法：$n$ 是二次剩余，当且仅当 $n = g^{2k}$，且此时一个解为 $g^k$
* 复杂度：$\mathcal O(\sqrt {Q p})$

## 三次剩余

* 定理：设 $p - 1 = kq$，则 $a$ 是模奇质数 $p$ 的一个 $k$ 次剩余的充分必要条件是：$a^q \equiv 1 (\bmod p)$

* 流程：随机 $z = \alpha + \beta Y + \gamma Y^2$，计算 $z^{\frac{n - 1}{3}}$，若其等于 $\beta_0 Y$，则 $\sqrt[3]{a} = \beta_0^{-1}$
* 概率：$\frac{1}{9} !$

# 线性代数

## 行列式

* 性质：
  1. 行列式与它的转置行列式值相等。
  2. 对换行列式两行（列），行列式变号。
  3. 行列式某一行（列）乘 $k$，等于用 $k$ 乘行列式。
  4. 如果有两行（列）成比例，则行列式为 $0$。
  5. 若行列式的某一行（列）的元素都是两数之和，则可以拆成两个行列式。
  6. 把行列式的某一行（列）的各元素乘上一个数加到另一行（列）上，行列式不变。

## 行列式展开

1. 若第 $i$ 行除了 $(i, j)$ 以外都是 $0$，则 $D = a_{i, j} A_{i, j}$
2. 行列式等于任意一行（列）的元素和其对应的代数余子式乘积之和。
3. 行列式某一行与另一行对应元素的代数余子式乘积之和等于 $0$。