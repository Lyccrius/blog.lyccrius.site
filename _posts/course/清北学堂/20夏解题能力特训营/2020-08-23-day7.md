---
layout: post
title:  数学
date:   2020-08-23
author: 钟皓曦
categories: 
---

# 初等数论

## 素数的判定（素性测试）

*   Miller-Rabin素性测试
*   如果 $n$ 为素数，取 $a \lt n$，设 $n - 1 = d \times 2^r$，则要么 $a^d \equiv 1 \pmod n$，要么 $\exist 0 \le i \lt r, s.t.~ a^{d \times 2^i} \equiv -1 \pod n$
*   常规做法：选取 $k$ 个不同的数进行 Miller-Rabin 素性测试
*   如果都通过则为质数
*   $2, 3, 5, 7, 13, 29, 37, 89$
*   $\mathcal O(k \log n)$

```cpp
bool MillerRabin(int n, int a) {
    int d = n - 1;
    int r = 0;
    while (d & 1 == 0) {
        d /= 2;
        r += 1;
    }
    int x = pow(a, d, n);
    if (x == 1) return true;
    for (int i = 0; i < r; i++) {
        //int p = pow(2, i, n);
        //int x = pow(a, d * p, n);
        if (x == n - 1) return true;
        x = 1ll * x * x % n;
    }
    return false;
}
```

### Miller-Rabin 练习题

*   HDU 2138
*   Luogu 3383
*   BZOJ 4802

## 原根

*   原根的定义：
*   如果 $a$ 模 $m$ 的阶等于 $\phi(m)$，则 $a$ 叫做 $m$ 的原根
*   阶的定义：
*   找到一个最小的 $k$，使得 $a^k = a^0$，则 $k$ 是 $a$ 的阶
*   对于正整数 $m$，$m$ 有原根当且仅当 $m = 2, 4, p^a, 2p^a$，其中 $p$ 是奇素数
*   原根怎么求？
    1.  暴力
    2.  优化暴力

```cpp
int PrimitiveRoot(int p) {
    int phiP = phi(p);
    int a = 2;
    while (true)
}