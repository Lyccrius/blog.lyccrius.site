---
layout: post
title: "《算法竞赛进阶指南》0x04 二分"
date:   2022-08-26
categories: course sfjs-jjzn
---

二分的基础的用法是在单调序列或单调函数中进行查找。

因此，当问题的答案具有单调性时，就可以通过二分把求解转化为判定（根据复杂度理论，判定的难度小于求解），这使得二分的运用范围变得很广泛。

进一步地，我们还可以扩展到通过三分法去解决单峰函数的极值以及相关问题。

二分的视线方法多种多样，但是其细节之处确实需要仔细考虑。

> * 对于整数域上的二分，需要注意终止边界、左右区间取舍时的开闭情况，避免漏掉答案或造成死循环；
> * 对于实数域上的二分，需要注意精度问题。

## 整数集合上的二分

二分的写法保证最终答案处于闭区间 $$[l,r]$$ 以内，

循环以 $$l=r$$ 结束，

每次二分的中间值 $$mid$$ 会归属于左半段或右半段二者之一。

> * 在单调递增序列 $$a$$ 中查找 $$\geq x$$ 的数中最小的一个（即 $$x$$ 或 $$x$$ 的后继）：
> ```
> while (l < r) {
>    int mid = (l + r) >> 1;
>    if (a[mid] >= x) r = mid; else l = mid + 1;
> }
> return a[l];
> ```
> * 在单调递增序列 $$a$$ 中查找 $$\leq x$$ 的数中最大的一个（即 $$x$$ 或 $$x$$ 的前驱）：
> ```
> while (l < r) {
>    int mid = (l + r + 1) >> 1;
>    if (a[mid] <= x) l = mid; else r = mid - 1;
> }
> return a[l];
> ```

在第一段代码中，若 $$a[mid]\geq x$$，

则根据序列 $$a$$ 的单调性，$$mid$$ 之后的数会更大，

所以 $$\geq x$$ 的最小的数不可能在 $$mid$$ 之后，可行区间应该缩小为左半段。

因为 $$mid$$ 也可能是答案，故此时应取 $$r=mid$$。

同理，若 $$a[mid]>x$$，取 $$r=mid-1$$。

在第二段代码中，若 $$a[mid]\geq x$$，

则根据序列 $$a$$ 的单调性，$$mid$$ 之前的数会更小，

所以 $$\leq x$$ 的最大的数不可能在 $$mid$$ 之前，可行区域应该缩小为